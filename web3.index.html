<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Student Data Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="flex min-h-screen bg-gray-100">
    <aside class="w-64 bg-blue-900 text-white p-4">
        <h2 class="text-xl font-bold mb-6">DISE Portal</h2>
        <nav>
            <ul>
                <li class="mb-3"><button onclick="showStandards()" class="hover:text-yellow-300">Manage Students</button></li>
            </ul>
        </nav>
    </aside>

    <main id="mainContent" class="flex-1 p-6">
        <h1 class="text-2xl font-bold">Welcome</h1>
        <p class="mt-2">Click <b>Manage Students</b> to view Standards.</p>
    </main>

    <script>
        // Demo student data
        const studentsData = {
            1: [
                { roll: 1, name: "Raj Patel", father: "Ketan Patel", mother: "Rekha Patel", caste: "General", sub: "Patel" },
                { roll: 2, name: "Amit Shah", father: "Mahesh Shah", mother: "Sunita Shah", caste: "OBC", sub: "Yadav" }
            ],
            2: [
                { roll: 1, name: "Rina Mehta", father: "Paresh Mehta", mother: "Kavita Mehta", caste: "SC", sub: "Valmiki" }
            ]
        };

        const subCastes = {
            General: ["Patel", "Brahmin", "Other"],
            OBC: ["Yadav", "Kurmi", "Other"],
            SC: ["Valmiki", "Chamar", "Other"],
            ST: ["Gonds", "Bhils", "Other"]
        };

        // Show Standards
        function showStandards() {
            let html = `<h1 class="text-2xl font-bold mb-4">Select Standard</h1><ul class="list-disc pl-6">`;
            for (let i = 1; i <= 8; i++) {
                html += `<li><button class="text-blue-600 underline" onclick="showStudents(${i})">Standard ${i}</button></li>`;
            }
            html += `</ul>`;
            document.getElementById("mainContent").innerHTML = html;
        }

        // Show Students (now called after save/add)
        function showStudents(std) {
            let html = `<h1 class="text-2xl font-bold mb-4">Students in Standard ${std}</h1>`;
            html += `<button onclick="addStudent(${std})" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-800 mb-4">Add Student</button>`;

            if (!studentsData[std] || studentsData[std].length === 0) {
                html += `<p>No students available.</p>`;
            } else {
                html += `<ul class="list-decimal pl-6">`;
                studentsData[std].forEach(s => {
                    html += `<li>${s.name} <button class="text-blue-600 underline" onclick="editStudent(${std},${s.roll})">Edit</button></li>`;
                });
                html += `</ul>`;
            }
            document.getElementById("mainContent").innerHTML = html;
        }

        // Add Student Form
        function addStudent(std) {
            let casteOptions = ["General", "OBC", "SC", "ST"].map(c =>
                `<option value="${c}">${c}</option>`
            ).join("");

            let subOptions = subCastes.General.map(sc =>
                `<option value="${sc}">${sc}</option>`
            ).join("");

            let html = `
                <h1 class="text-2xl font-bold mb-4">Add New Student to Standard ${std}</h1>
                <form id="addForm" class="bg-white p-6 rounded shadow-md max-w-lg">
                    <div class="mb-4">
                        <label class="block mb-1 font-semibold">Roll No</label>
                        <input type="number" id="roll" class="w-full border px-3 py-2 rounded" required>
                    </div>
                    <div class="mb-4">
                        <label class="block mb-1 font-semibold">Student Name</label>
                        <input type="text" id="name" class="w-full border px-3 py-2 rounded" required>
                    </div>
                    <div class="mb-4">
                        <label class="block mb-1 font-semibold">Father Name</label>
                        <input type="text" id="father" class="w-full border px-3 py-2 rounded" required>
                    </div>
                    <div class="mb-4">
                        <label class="block mb-1 font-semibold">Mother Name</label>
                        <input type="text" id="mother" class="w-full border px-3 py-2 rounded" required>
                    </div>
                    <div class="mb-4">
                        <label class="block mb-1 font-semibold">Caste</label>
                        <select id="caste" class="w-full border px-3 py-2 rounded" onchange="updateSubCaste(this.value)">
                            ${casteOptions}
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block mb-1 font-semibold">Sub-Caste</label>
                        <select id="subCaste" class="w-full border px-3 py-2 rounded">
                            ${subOptions}
                        </select>
                    </div>
                    <button type="submit" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-800">Add Student</button>
                </form>
            `;
            document.getElementById("mainContent").innerHTML = html;

            document.getElementById("addForm").onsubmit = function(e) {
                e.preventDefault();
                const newStudent = {
                    roll: parseInt(document.getElementById("roll").value),
                    name: document.getElementById("name").value,
                    father: document.getElementById("father").value,
                    mother: document.getElementById("mother").value,
                    caste: document.getElementById("caste").value,
                    sub: document.getElementById("subCaste").value
                };

                // Add the new student to the studentsData array
                if (!studentsData[std]) {
                    studentsData[std] = [];
                }
                studentsData[std].push(newStudent);

                // Show the updated list of students
                showStudents(std);
            };
        }

        // Edit Form
        function editStudent(std, roll) {
            const student = studentsData[std].find(s => s.roll === roll);

            let casteOptions = ["General", "OBC", "SC", "ST"].map(c =>
                `<option value="${c}" ${c===student.caste?"selected":""}>${c}</option>`
            ).join("");

            let subOptions = subCastes[student.caste].map(sc =>
                `<option value="${sc}" ${sc===student.sub?"selected":""}>${sc}</option>`
            ).join("");

            let html = `
                <h1 class="text-2xl font-bold mb-4">Edit Student</h1>
                <form id="editForm" class="bg-white p-6 rounded shadow-md max-w-lg">
                    <div class="mb-4">
                        <label class="block mb-1 font-semibold">Roll No</label>
                        <input type="text" id="roll" value="${student.roll}" class="w-full border px-3 py-2 rounded" readonly>
                    </div>
                    <div class="mb-4">
                        <label class="block mb-1 font-semibold">Student Name</label>
                        <input type="text" id="name" value="${student.name}" class="w-full border px-3 py-2 rounded">
                    </div>
                    <div class="mb-4">
                        <label class="block mb-1 font-semibold">Father Name</label>
                        <input type="text" id="father" value="${student.father}" class="w-full border px-3 py-2 rounded">
                    </div>
                    <div class="mb-4">
                        <label class="block mb-1 font-semibold">Mother Name</label>
                        <input type="text" id="mother" value="${student.mother}" class="w-full border px-3 py-2 rounded">
                    </div>
                    <div class="mb-4">
                        <label class="block mb-1 font-semibold">Caste</label>
                        <select id="caste" class="w-full border px-3 py-2 rounded" onchange="updateSubCaste(this.value)">
                            ${casteOptions}
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block mb-1 font-semibold">Sub-Caste</label>
                        <select id="subCaste" class="w-full border px-3 py-2 rounded">
                            ${subOptions}
                        </select>
                    </div>
                    <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-800">Save</button>
                </form>
            `;
            document.getElementById("mainContent").innerHTML = html;

            // Handle save
            document.getElementById("editForm").onsubmit = function(e) {
                e.preventDefault();
                const updated = {
                    roll: parseInt(document.getElementById("roll").value),
                    name: document.getElementById("name").value,
                    father: document.getElementById("father").value,
                    mother: document.getElementById("mother").value,
                    caste: document.getElementById("caste").value,
                    sub: document.getElementById("subCaste").value
                };
                
                // Find and update the student in the array
                const index = studentsData[std].findIndex(s => s.roll === updated.roll);
                if (index !== -1) {
                    studentsData[std][index] = updated;
                }

                // Show the updated list of students
                showStudents(std);
            };
        }

        // Update sub-caste dropdown
        function updateSubCaste(caste) {
            const subSelect = document.getElementById("subCaste");
            subSelect.innerHTML = "";
            if (subCastes[caste]) {
                subCastes[caste].forEach(sc => {
                    const opt = document.createElement("option");
                    opt.value = sc;
                    opt.textContent = sc;
                    subSelect.appendChild(opt);
                });
            }
        }
    </script>
</body>
</html>